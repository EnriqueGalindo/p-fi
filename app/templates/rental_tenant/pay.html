{% extends "base_rental.html" %}
{% block content %}
<div class="card" style="max-width:900px;">
  <h1 style="margin-top:0;">Make a payment</h1>

  <p class="muted">
    Covered month: <b>{{ due_ym }}</b><br>
    Base rent: <b>${{ "%.2f"|format(rent) }}</b><br>
    Late fee: <b>${{ "%.2f"|format(policy.late_fee) }}</b><br>
    Total due now: <b>${{ "%.2f"|format(policy.total_due) }}</b>
  </p>

  <form method="POST"
      action="{{ url_for('rental_tenant.create_checkout_session') }}"
      style="display:grid; gap:.75rem; max-width:520px;">

  {% if policy.allow_partial %}
    <div class="muted" style="font-size:12px;">
      You’re paying early — you can pay <b>half</b> now (to limit fees) or pay in full.
    </div>

    <label style="display:flex; gap:.6rem; align-items:flex-start;">
      <input type="radio" name="payment_choice" value="half" checked>
      <div>
        <div style="font-weight:800;">Pay half now</div>
        <div class="muted" style="font-size:12px;">
          ${{ "%.2f"|format((policy.total_due / 2.0)) }} (rounded to cents)
        </div>
      </div>
    </label>

    <label style="display:flex; gap:.6rem; align-items:flex-start;">
      <input type="radio" name="payment_choice" value="full">
      <div>
        <div style="font-weight:800;">Pay in full</div>
        <div class="muted" style="font-size:12px;">
          ${{ "%.2f"|format(policy.total_due) }}
        </div>
      </div>
    </label>

  {% else %}
    <input type="hidden" name="payment_choice" value="full">
    <div class="muted" style="font-size:12px;">
      Full payment is required right now.
    </div>
  {% endif %}

  <button class="btn" type="submit">Continue to Stripe</button>
  <a class="pill" href="{{ url_for('rental_tenant.tenant_portal') }}" style="width:max-content;">Back</a>
</form>

</div>
{% endblock %}
