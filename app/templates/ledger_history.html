{% extends "base.html" %}
{% block content %}
<div class="card">
  <h1>History / Revert</h1>
  <p class="muted">Choose a prior point to restore <code>latest.json</code>. Weâ€™ll first back up your current state.</p>

  <p><a href="{{ url_for('ledger.list_entries') }}">&larr; Back to Ledger</a></p>

  <table>
    <thead>
      <tr>
        <th>When</th>
        <th>Type</th>
        <th>Amount</th>
        <th>Note</th>
        <th style="width:1%">Action</th>
      </tr>
    </thead>
    <tbody>
    {% for r in rows %}
      <tr>
        <td class="muted">{{ r.ts }}</td>
        <td>{{ r.kind }}</td>
        <td>${{ '%.2f'|format(r.amount or 0) }}</td>
        <td>{{ r.note }}</td>
        <td>
          <form method="post" action="{{ url_for('ledger.revert_to_snapshot') }}" onsubmit="return confirm('Restore to this point? The current state will be backed up.');">
            <input type="hidden" name="snap_id" value="{{ r.snap_id }}">
            <button type="submit">Restore</button>
          </form>
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
